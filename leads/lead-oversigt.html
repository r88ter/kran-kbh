<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lead Oversigt - Kranudlejning KÃ¸benhavn</title>
  <meta name="description" content="Oversigt over varme leads til kranudlejning i KÃ¸benhavnsomrÃ¥det. Hurtig adgang til nye kundehenvendelser." />
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      background: #f9f9f9;
      color: #222;
      margin: 0; padding: 1rem;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      color: #0a74da;
      margin-bottom: 1rem;
      text-align: center;
    }
    #lead-list {
      list-style: none;
      padding: 0;
      max-width: 600px;
      width: 100%;
    }
    #lead-list li {
      background: white;
      margin-bottom: 1rem;
      padding: 1rem 1.5rem;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
      cursor: pointer;
      transition: box-shadow 0.2s ease;
    }
    #lead-list li:hover {
      box-shadow: 0 4px 12px rgb(0 0 0 / 0.15);
    }
    .lead-name {
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 0.2rem;
    }
    .lead-email, .lead-phone {
      font-size: 0.9rem;
      color: #555;
      margin-bottom: 0.3rem;
    }
    .no-leads {
      max-width: 600px;
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeeba;
      padding: 1rem 1.5rem;
      border-radius: 6px;
      text-align: center;
      margin-top: 2rem;
      font-weight: 600;
    }
    #login {
      max-width: 320px;
      background: white;
      padding: 2rem;
      border-radius: 6px;
      box-shadow: 0 2px 8px rgb(0 0 0 / 0.1);
      text-align: center;
    }
    #password-input {
      width: 100%;
      padding: 0.6rem;
      margin-bottom: 1rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    #login button {
      background: #0a74da;
      border: none;
      color: white;
      padding: 0.7rem 1.2rem;
      border-radius: 4px;
      font-size: 1rem;
      cursor: pointer;
    }
    #login button:hover {
      background: #095bb5;
    }
  </style>
</head>
<body>

  <h1>Lead Oversigt - Kranudlejning KÃ¸benhavn</h1>

  <div id="login">
    <p>Indtast kodeord for at se leads</p>
    <input type="password" id="password-input" placeholder="Kodeord" />
    <button id="login-btn">Log ind</button>
    <p id="login-error" style="color:#b00020; display:none;">Forkert kodeord, prÃ¸v igen.</p>
  </div>

  <ul id="lead-list" style="display:none;"></ul>

  <script>
    const CORRECT_PASSWORD = "MitHemmeligeKodeord"; // SÃ¦t dit kodeord her

    const loginDiv = document.getElementById("login");
    const leadList = document.getElementById("lead-list");
    const loginBtn = document.getElementById("login-btn");
    const passwordInput = document.getElementById("password-input");
    const loginError = document.getElementById("login-error");

    loginBtn.addEventListener("click", () => {
      const val = passwordInput.value.trim();
      if (val === CORRECT_PASSWORD) {
        loginDiv.style.display = "none";
        leadList.style.display = "block";
        hentLeads();
      } else {
        loginError.style.display = "block";
      }
    });

    // Google Sheets CSV URL - publiceret ark som CSV
    // SÃ¥dan finder du URL:
    // 1. Ã…bn dit Google Sheet
    // 2. Klik Filer -> Publicer pÃ¥ nettet -> VÃ¦lg ark -> VÃ¦lg CSV
    // 3. Kopier den URL herunder
    const sheetCsvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRbA-kIz4FBmzCsN28cpv0JKWZJqpzMlIcVI_acFIPvRfOTFuWOkYX1vgndfN5Rzwj__9Tmilr_JmoD/pubhtml?gid=0&single=true";

    async function hentLeads() {
      leadList.innerHTML = "<li>IndlÃ¦ser leads...</li>";
      try {
        const res = await fetch(sheetCsvUrl);
        if (!res.ok) throw new Error("NetvÃ¦rksfejl");

        const csvText = await res.text();

        const leads = csvTilArray(csvText);

        if (leads.length === 0) {
          leadList.innerHTML = '<div class="no-leads">Ingen nye leads lige nu.</div>';
          return;
        }

        leadList.innerHTML = "";

        leads.forEach((lead) => {
          const li = document.createElement("li");
          li.innerHTML = `
            <div class="lead-name">${lead.Navn || "Ukendt navn"}</div>
            <div class="lead-email">ðŸ“§ ${lead.Email || "-"}</div>
            <div class="lead-phone">ðŸ“ž ${lead.Telefon || "-"}</div>
          `;
          li.addEventListener("click", () => {
            alert(`Se detaljer for ${lead.Navn || "lead"}`);
          });
          leadList.appendChild(li);
        });
      } catch (error) {
        leadList.innerHTML = `<div class="no-leads">Fejl ved hentning af leads. PrÃ¸v igen senere.</div>`;
        console.error(error);
      }
    }

    // Simpel CSV-parser til at konvertere CSV til array af objekter
  function csvTilArray(csv) {
  const lines = csv.trim().split("\n");
  const headers = lines[0].split(",").map(h => h.trim());
  const data = lines.slice(1)
    .map(line => {
      const values = line.split(",").map(v => v.trim());
      const obj = {};
      headers.forEach((header, i) => {
        obj[header] = values[i] || "";
      });
      return obj;
    })
    // Filtrer rÃ¦kker hvor "Navn" er tom (eller anden vigtig kolonne)
    .filter(row => row.Navn && row.Navn.length > 0);
  return data;
}
    }
  </script>
</body>
</html>
